<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="enamad" content="61081844" />
    <title>Medical ProMax | پلتفرم تخصصی آزمون قلب</title>

    <!-- Resources -->
    <link href="https://cdn.jsdelivr.net/gh/rastikerdar/vazirmatn@v33.003/Vazirmatn-font-face.css" rel="stylesheet" type="text/css" />
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        medical: {
                            50: '#f0f7ff',
                            100: '#e0effe',
                            600: '#2563eb',
                            700: '#1d4ed8',
                            900: '#1e3a8a',
                            950: '#0f172a'
                        }
                    },
                    borderRadius: {
                        '3xl': '1.5rem',
                        '4xl': '2rem',
                    }
                }
            }
        }
    </script>

    <style>
        body {
            font-family: 'Vazirmatn', sans-serif;
            background-color: #f8fafc;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }
        .glass-dark {
            background: rgba(15, 23, 42, 0.9);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .glass-light {
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(8px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }
        .premium-shadow {
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.05), 0 8px 10px -6px rgba(0, 0, 0, 0.05);
        }
        .option-transition {
            transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .safe-area-bottom {
            padding-bottom: env(safe-area-inset-bottom);
        }
        @keyframes subtle-float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-5px); }
            100% { transform: translateY(0px); }
        }
        .animate-float {
            animation: subtle-float 4s ease-in-out infinite;
        }
    </style>
</head>
<body class="min-h-screen flex flex-col overflow-x-hidden select-none" oncontextmenu="return false;">

    <div id="app" class="flex-grow flex flex-col"></div>

    <!-- Navigation Modal -->
    <div id="nav-modal" class="fixed inset-0 z-[60] hidden">
        <div class="absolute inset-0 bg-slate-950/40 backdrop-blur-sm" onclick="toggleNavModal()"></div>
        <div class="absolute bottom-0 left-0 right-0 bg-white rounded-t-[2.5rem] p-8 shadow-2xl animate-in slide-in-from-bottom duration-300 max-h-[85vh] overflow-hidden flex flex-col">
            <div class="w-12 h-1.5 bg-slate-200 rounded-full mx-auto mb-6"></div>
            <div class="flex justify-between items-center mb-6">
                <h4 class="text-xl font-black text-slate-800">فهرست سوالات</h4>
                <div class="flex gap-2 text-[10px] font-bold">
                    <span class="flex items-center gap-1 text-emerald-600"><span class="w-2 h-2 bg-emerald-500 rounded-full"></span> پاسخ‌داده</span>
                    <span class="flex items-center gap-1 text-slate-400"><span class="w-2 h-2 bg-slate-200 rounded-full"></span> باقی‌مانده</span>
                </div>
            </div>
            <div id="nav-grid" class="grid grid-cols-5 gap-3 overflow-y-auto pb-10">
                <!-- Grid items -->
            </div>
        </div>
    </div>

    <script>
        const CONFIG = {
            brand: "Medical ProMax",
            user: "محمد براریان",
            storageKey: "medical_promax_pro_state"
        };

        const examDatabase = {
            sections: [
                { id: 'congenital', title: 'مادرزادی قلب', icon: 'baby', color: 'from-blue-600 to-indigo-600' },
                { id: 'valvular', title: 'بیماری‌های دریچه‌ای', icon: 'refresh-cw', color: 'from-rose-600 to-red-600' },
                { id: 'arrhythmia', title: 'آریتمی و EPS', icon: 'activity', color: 'from-amber-500 to-orange-600' },
                { id: 'heart_failure', title: 'نارسایی قلب', icon: 'heart', color: 'from-purple-600 to-violet-700' },
                { id: 'ihd', title: 'ایسکمیک (CAD)', icon: 'zap', color: 'from-orange-500 to-red-500' },
                { id: 'hypertension', title: 'فشار خون', icon: 'droplet', color: 'from-emerald-500 to-teal-600' },
                { id: 'pericardial', title: 'پریکارد و عفونی', icon: 'shield-check', color: 'from-cyan-500 to-blue-500' },
                { id: 'miscellaneous', title: 'اورژانس‌ها', icon: 'plus-square', color: 'from-slate-700 to-slate-900' }
            ],
            questions: []
        };

        function populateDatabase() {
            const pool = [
                {
                    q: "در ناهنجاری ابشتاین (Ebstein anomaly)، خطر اصلی ایست قلبی ناگهانی (SCD) ناشی از کدام مورد است؟",
                    options: ["جابجایی آناتومیک لت‌های تریکاسپید", "مسیرهای فرعی دهلیزی-بطنی (WPW)", "بزرگی شدید دهلیز راست", "نارسایی سیانوتیک بطن راست"],
                    correct: 1,
                    analysis: {
                        options: [
                            "گزینه ۱: جابجایی لت‌ها یک نقص ساختاری است و مستقیماً باعث آریتمی کشنده نمی‌شود.",
                            "گزینه ۲: حضور مسیرهای فرعی در ۲۰٪ بیماران ابشتاین علت اصلی تاکی‌آریتمی‌های بطنی است.",
                            "گزینه ۳: دهلیزی شدن بطن راست منجر به نارسایی قلبی می‌شود نه مرگ ناگهانی.",
                            "گزینه ۴: نارسایی بطن راست عارضه‌ای تدریجی است."
                        ],
                        points: [
                            "ناهنجاری ابشتاین شایع‌ترین علت مادرزادی نارسایی تریکاسپید است.",
                            "نمای 'قلب جعبه‌ای' در رادیوگرافی از ویژگی‌های تشخیصی است.",
                            "سندرم WPW در این بیماران باید همواره مد نظر باشد."
                        ]
                    }
                }
            ];

            let gId = 1;
            examDatabase.sections.forEach(sec => {
                for(let i=1; i<=50; i++) {
                    const t = pool[Math.floor(Math.random() * pool.length)];
                    examDatabase.questions.push({...t, id: gId++, localId: i, category: sec.id});
                }
            });
        }

        let state = {
            view: 'login',
            section: null,
            index: 0,
            answers: {},
            showAnalysis: false
        };

        function save() { localStorage.setItem(CONFIG.storageKey, JSON.stringify(state)); }
        function load() { const s = localStorage.getItem(CONFIG.storageKey); if(s) { const p = JSON.parse(s); if(p.view !== 'login') state = p; } }

        function render() {
            const root = document.getElementById('app');
            if (state.view === 'login') root.innerHTML = viewLogin();
            else if (state.view === 'dashboard') root.innerHTML = viewDashboard();
            else if (state.view === 'quiz') root.innerHTML = viewQuiz();
            lucide.createIcons();
            save();
        }

        function viewLogin() {
            return `
                <div class="min-h-screen flex flex-col items-center justify-center p-6 bg-slate-950">
                    <div class="absolute inset-0 overflow-hidden pointer-events-none opacity-20">
                        <div class="absolute top-[-10%] right-[-10%] w-[300px] h-[300px] bg-blue-600 rounded-full blur-[120px]"></div>
                        <div class="absolute bottom-[-10%] left-[-10%] w-[300px] h-[300px] bg-indigo-600 rounded-full blur-[120px]"></div>
                    </div>
                    
                    <div class="w-full max-w-sm glass-dark p-10 rounded-[3rem] text-center relative z-10">
                        <div class="w-20 h-20 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-3xl mx-auto mb-8 flex items-center justify-center shadow-lg shadow-blue-500/20 animate-float">
                            <i data-lucide="stethoscope" class="w-10 h-10 text-white"></i>
                        </div>
                        <h1 class="text-3xl font-black text-white mb-2">${CONFIG.brand}</h1>
                        <p class="text-slate-400 text-xs font-bold tracking-[0.2em] mb-12">PROFESSIONAL MEDICAL PORTAL</p>
                        
                        <div class="space-y-4 text-right">
                            <input id="u" type="text" class="w-full bg-slate-900/50 border border-slate-800 text-white px-6 py-5 rounded-2xl outline-none focus:border-blue-500 transition-all text-sm" placeholder="نام کاربری">
                            <input id="p" type="password" class="w-full bg-slate-900/50 border border-slate-800 text-white px-6 py-5 rounded-2xl outline-none focus:border-blue-500 transition-all text-sm" placeholder="رمز عبور">
                            <button onclick="handleLogin()" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-black py-5 rounded-2xl shadow-xl shadow-blue-600/20 active:scale-[0.98] transition-all mt-4 text-lg">ورود به پنل</button>
                        </div>
                    </div>
                </div>
            `;
        }

        function viewDashboard() {
            return `
                <header class="bg-white/80 backdrop-blur-md border-b border-slate-100 px-6 py-4 sticky top-0 z-50">
                    <div class="max-w-4xl mx-auto flex justify-between items-center">
                        <div class="flex items-center gap-3">
                            <div class="bg-slate-950 p-2 rounded-xl text-white shadow-lg"><i data-lucide="layout-grid" class="w-5 h-5"></i></div>
                            <div>
                                <h2 class="font-black text-slate-900 text-lg leading-none mb-1">${CONFIG.brand}</h2>
                                <p class="text-[10px] text-slate-400 font-black tracking-widest uppercase">Digital Training</p>
                            </div>
                        </div>
                        <button onclick="logout()" class="w-10 h-10 rounded-xl bg-slate-50 flex items-center justify-center text-slate-400 hover:text-red-500 transition-colors">
                            <i data-lucide="log-out" class="w-5 h-5"></i>
                        </button>
                    </div>
                </header>

                <main class="max-w-4xl mx-auto p-6 safe-area-bottom">
                    <div class="bg-gradient-to-br from-slate-900 to-slate-800 rounded-[2.5rem] p-8 mb-10 text-white shadow-2xl relative overflow-hidden group">
                        <div class="absolute -right-10 -top-10 w-40 h-40 bg-blue-500/10 rounded-full group-hover:scale-110 transition-transform duration-700"></div>
                        <div class="relative z-10">
                            <p class="text-xs font-bold text-blue-400 mb-2 uppercase tracking-widest">پزشک محترم</p>
                            <h3 class="text-3xl font-black mb-6 leading-tight">${CONFIG.user}</h3>
                            <div class="flex gap-3">
                                <div class="bg-white/5 backdrop-blur-md px-5 py-3 rounded-2xl border border-white/5">
                                    <span class="text-2xl font-black block leading-none">۴۰۰</span>
                                    <span class="text-[9px] font-bold opacity-50 uppercase tracking-tighter">سوال کل</span>
                                </div>
                                <div class="bg-white/5 backdrop-blur-md px-5 py-3 rounded-2xl border border-white/5">
                                    <span class="text-2xl font-black block leading-none text-blue-400">${Object.keys(state.answers).length}</span>
                                    <span class="text-[9px] font-bold opacity-50 uppercase tracking-tighter">تکمیل شده</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <h4 class="text-slate-800 font-black mb-6 px-2 flex items-center gap-2">
                        <span class="w-1 h-5 bg-blue-600 rounded-full"></span>
                        انتخاب سرفصل آموزشی
                    </h4>

                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                        ${examDatabase.sections.map(sec => `
                            <div onclick="initQuiz('${sec.id}')" class="bg-white p-6 rounded-[2rem] border border-slate-100 shadow-sm active:scale-[0.98] hover:shadow-xl transition-all flex items-center gap-5 group">
                                <div class="bg-gradient-to-br ${sec.color} w-16 h-16 rounded-2xl flex items-center justify-center text-white shadow-lg shadow-inner group-hover:rotate-6 transition-transform">
                                    <i data-lucide="${sec.icon}" class="w-8 h-8"></i>
                                </div>
                                <div class="flex-grow">
                                    <h4 class="font-black text-slate-900 text-lg mb-0.5">${sec.title}</h4>
                                    <p class="text-[10px] text-slate-400 font-bold uppercase">50 Specialized MCQs</p>
                                </div>
                                <i data-lucide="chevron-left" class="text-slate-200 group-hover:text-blue-500 transition-colors"></i>
                            </div>
                        `).join('')}
                    </div>
                </main>
            `;
        }

        function viewQuiz() {
            const section = examDatabase.sections.find(s => s.id === state.section);
            const questions = examDatabase.questions.filter(q => q.category === state.section);
            const q = questions[state.index];
            const answer = state.answers[q.id];

            return `
                <div class="flex flex-col min-h-screen bg-slate-50">
                    <header class="bg-white border-b border-slate-100 px-6 py-4 flex justify-between items-center sticky top-0 z-50">
                        <button onclick="state.view='dashboard';render()" class="w-10 h-10 rounded-xl bg-slate-50 flex items-center justify-center text-slate-400"><i data-lucide="chevron-right"></i></button>
                        <div class="text-center">
                            <p class="text-[9px] font-black text-blue-600 uppercase tracking-widest leading-none mb-1">${section.title}</p>
                            <button onclick="toggleNavModal()" class="text-base font-black text-slate-900 flex items-center gap-1.5 mx-auto">
                                سوال ${q.localId} از ۵۰
                                <i data-lucide="chevron-down" class="w-4 h-4 text-blue-500 mt-0.5"></i>
                            </button>
                        </div>
                        <div class="w-10"></div>
                    </header>

                    <main class="flex-grow p-6 safe-area-bottom">
                        <div class="bg-white rounded-[2.5rem] p-8 md:p-12 shadow-sm border border-slate-100 mb-8 premium-shadow animate-in fade-in duration-500">
                            <div class="mb-10">
                                <h3 class="text-xl md:text-2xl font-black text-slate-900 leading-[1.7]">
                                    <span class="text-blue-600/20 text-4xl font-black block mb-2 leading-none">${q.localId}</span>
                                    ${q.q}
                                </h3>
                            </div>

                            <div class="space-y-4">
                                ${q.options.map((opt, i) => {
                                    let cls = "bg-slate-50 border-transparent text-slate-700 hover:bg-slate-100";
                                    let decoration = `<div class="w-8 h-8 rounded-xl border border-slate-200 flex items-center justify-center text-xs font-black text-slate-400 group-active:scale-90 transition-transform">${i+1}</div>`;
                                    
                                    if (answer !== undefined) {
                                        if (i === q.correct) {
                                            cls = "bg-emerald-50 border-emerald-500 text-emerald-900 ring-4 ring-emerald-500/10";
                                            decoration = `<div class="bg-emerald-500 text-white w-8 h-8 rounded-xl flex items-center justify-center"><i data-lucide="check" class="w-4 h-4"></i></div>`;
                                        } else if (i === answer) {
                                            cls = "bg-red-50 border-red-500 text-red-900 ring-4 ring-red-500/10";
                                            decoration = `<div class="bg-red-500 text-white w-8 h-8 rounded-xl flex items-center justify-center"><i data-lucide="x" class="w-4 h-4"></i></div>`;
                                        }
                                    }

                                    return `
                                        <div onclick="pick(${q.id}, ${i})" class="option-transition p-5 rounded-2xl border-2 flex items-center gap-4 cursor-pointer group ${cls}">
                                            ${decoration}
                                            <span class="text-base font-bold flex-1">${opt}</span>
                                        </div>
                                    `;
                                }).join('')}
                            </div>
                        </div>

                        ${(answer !== undefined || state.showAnalysis) ? `
                            <div class="space-y-4 animate-in slide-in-from-bottom duration-500 mb-20">
                                <div class="bg-white rounded-[2rem] p-8 border border-slate-100 shadow-sm">
                                    <div class="flex items-center gap-3 mb-6">
                                        <div class="bg-blue-100 text-blue-600 p-2 rounded-xl"><i data-lucide="list-checks" class="w-5 h-5"></i></div>
                                        <h4 class="font-black text-slate-900 text-lg">بررسی گزینه‌ها</h4>
                                    </div>
                                    <div class="space-y-4">
                                        ${q.analysis.options.map(line => `
                                            <div class="flex items-start gap-3 p-4 bg-slate-50 rounded-2xl text-slate-700 text-sm leading-7 border-r-4 border-blue-200">
                                                <span>${line}</span>
                                            </div>
                                        `).join('')}
                                    </div>
                                </div>

                                <div class="bg-emerald-950 rounded-[2rem] p-8 text-white shadow-xl relative overflow-hidden">
                                    <div class="absolute -right-10 top-0 opacity-10"><i data-lucide="award" class="w-40 h-40"></i></div>
                                    <div class="relative z-10">
                                        <div class="flex items-center gap-3 mb-6">
                                            <div class="bg-emerald-500 p-2 rounded-xl"><i data-lucide="zap" class="w-5 h-5 text-white"></i></div>
                                            <h4 class="font-black text-lg">نکات طلایی امتحانی</h4>
                                        </div>
                                        <ul class="space-y-4">
                                            ${q.analysis.points.map(pt => `
                                                <li class="flex items-start gap-4 text-emerald-100/90 text-sm leading-7">
                                                    <span class="w-1.5 h-1.5 rounded-full bg-emerald-400 shrink-0 mt-2.5 shadow-lg shadow-emerald-400/50"></span>
                                                    <span>${pt}</span>
                                                </li>
                                            `).join('')}
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        ` : ''}
                    </main>

                    <footer class="bg-white/90 backdrop-blur-xl border-t border-slate-100 p-5 flex gap-3 sticky bottom-0 z-[50] safe-area-bottom">
                        <button onclick="prev()" ${state.index === 0 ? 'disabled' : ''} class="flex-1 py-4 rounded-2xl bg-slate-50 border border-slate-200 font-black text-slate-500 disabled:opacity-20 active:scale-95 transition-all text-sm">قبلی</button>
                        <button onclick="state.showAnalysis=!state.showAnalysis;render()" class="w-14 h-14 rounded-2xl bg-blue-50 text-blue-600 flex items-center justify-center active:scale-90 transition-all">
                            <i data-lucide="lightbulb" class="w-6 h-6"></i>
                        </button>
                        <button onclick="next()" ${state.index === questions.length - 1 ? 'disabled' : ''} class="flex-1 py-4 rounded-2xl bg-slate-900 text-white font-black shadow-xl active:scale-95 transition-all text-sm">بعدی</button>
                    </footer>
                </div>
            `;
        }

        // Logic
        function handleLogin() {
            const u = document.getElementById('u').value;
            const p = document.getElementById('p').value;
            if(u === 'admin' && p === 'admin') { state.view = 'dashboard'; render(); }
        }
        function logout() { state.view = 'login'; state.answers = {}; localStorage.removeItem(CONFIG.storageKey); render(); }
        function initQuiz(sid) { state.section = sid; state.index = 0; state.showAnalysis = false; state.view = 'quiz'; render(); window.scrollTo(0,0); }
        function toggleNavModal() {
            const m = document.getElementById('nav-modal');
            const g = document.getElementById('nav-grid');
            if(m.classList.contains('hidden')) {
                const qs = examDatabase.questions.filter(q => q.category === state.section);
                g.innerHTML = qs.map((q, i) => {
                    const ok = state.answers[q.id] !== undefined ? 'bg-emerald-500 text-white shadow-lg shadow-emerald-500/20' : 'bg-slate-100 text-slate-400';
                    const act = state.index === i ? 'ring-2 ring-blue-600 ring-offset-4' : '';
                    return `<button onclick="jumpTo(${i})" class="aspect-square rounded-2xl flex items-center justify-center font-black text-sm transition-all ${ok} ${act}">${q.localId}</button>`;
                }).join('');
                m.classList.remove('hidden');
            } else m.classList.add('hidden');
        }
        function jumpTo(i) { state.index = i; state.showAnalysis = false; toggleNavModal(); render(); window.scrollTo(0,0); }
        function pick(qid, i) { if(state.answers[qid] !== undefined) return; state.answers[qid] = i; render(); }
        function next() { state.index++; state.showAnalysis = false; render(); window.scrollTo(0,0); }
        function prev() { state.index--; state.showAnalysis = false; render(); window.scrollTo(0,0); }

        populateDatabase();
        load();
        render();

    </script>
</body>
</html>
